
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<html>
 <head>
   <link type="text/css" href="http://www.flossmanuals.net/_templates/prettify/src/prettify.css" rel="Stylesheet" />
   <script type="text/javascript" src="http://www.flossmanuals.net/_templates/prettify/src/prettify.js"></script>

   <link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
   <link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
   <script type="text/javascript" src="/static/js/jquery-1.7.js"></script>
<!--
   <script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
-->   
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
   <script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
   <script type="text/javascript" src="/site_static/js/booki.js"></script>

   <link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
   <script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

   <link type="text/css" href="/static/css/booki_fm.css" rel="Stylesheet"/ >
<style>
.template {
	display: none !important;
}


#header {
    background-color: transparent !important;
}
.paginator { padding:.5em .75em; float:left; font:normal .8em arial; }
 
.paginator .prev-na,
.paginator .next-na {
	padding:.3em;
	font-weight: bold;
/*	font:bold .875em arial; */
}
 
.paginator .prev-na,
.paginator .next-na {
/*	border:1px solid #ccc; 
	background-color:#f9f9f9; */
	color:#aaa;
	font-weight:normal;
}
 
.paginator .prev a, .paginator .prev a:visited,
.paginator .next a, .paginator .next a:visited {
/*	border:1px solid #c2ee62; 
	background-color:#edfdd0; */
	color:#234f32;
	padding:.3em;
/*	font:bold .875em arial; */
        font-weight: bold;
}
 
.paginator .prev, .paginator .prev-na { margin-right:.5em; }
.paginator .next, .paginator .next-na { margin-left:.5em; }
 
.paginator .page a, .paginator .page a:visited, .paginator .curr {
	padding:.25em;
	font-weight: normal;
/*	font:normal .875em verdana; */
/*	border:1px solid #C2EE62; 
	background-color:#EDFDD0; */
	margin:0em .25em;	
	color:#006000;
}
 
.paginator .curr { 
/*	background-color:#234f32; 
	color:#fff; */
	border:1px solid #234f32; 
	font-weight:bold;
	font-size:1em;
}
 
.paginator .page a:hover,
.paginator .curr a:hover,
.paginator .prev a:hover,
.paginator .next a:hover {
/*	color:#fff;
	background-color:#234f32;
	border:1px solid #234f32; */
}
</style>
 <script type="text/javascript">
      $(function() {
   $.booki.sputnikDispatcherURL = "/_sputnik/";
    });
   </script>

   <script type="text/javascript">
     $(function() {
	 // open debug window
	 $.booki.debug.init();
	 
	 
	 $("A.debug").click(function() {
	     $("#bookidebug").dialog("open");
	     return false;
	 });
     });
   </script>

   
<title>/chapter: Web-Based-Csound / CSound</title>
<link type="text/css" href="/site_static/css/editor.css" rel="Stylesheet" />

<script src="http://assets.annotateit.org/annotator/v1.2.5/annotator-full.min.js"></script>
<link rel="stylesheet" href="http://assets.annotateit.org/annotator/v1.2.5/annotator.min.css">



<link rel="alternate" type="application/rss+xml" title="RSS feed for CSound" href="/feeds/rss/book/csound/" /> 
<link rel="alternate" type="application/atom+xml" title="Atom feed for CSound" href="/feeds/atom/book/csound/" /> 

<link rel="alternate" type="application/rss+xml" title="RSS feed for chapter Web-Based-Csound" href="/feeds/rss/chapter/csound/csound/" /> 
<link rel="alternate" type="application/atom+xml" title="Atom feed for chapter Web-Based-Csound" href="/feeds/atom/chapter/csound/csound/" /> 


 </head>
<body onload="prettyPrint()" >
<!-- testis -->

<script type="text/javascript">
$(function() {
    $("#snippetdialog").dialog({autoOpen: false});
});
</script>


<div id="snippetdialog" title="Basic dialog">
        <p></p>
</div>



<div id="page-container"> 
<style>
body
{
margin:0;
padding:0
}
#header
{
position:absolute;
top:23px;
width:100%;
background-image: url('http://www.flossmanuals.net/_templates/fm_resources/header_bg.gif');
background-position: 700px 0px; /* this places the orange background at
an offset, making sure it doesn't underlap the left side of the gif */
background-repeat: no-repeat;
}

#fmheader {
    background-image: url("http://en.flossmanuals.net/_templates/fm_resources/header_bg.gif");
    background-position: 600px 0;
    background-repeat: no-repeat;
    position: absolute;
    top: 23px;
    width: 100%;
}
#header_image
{
margin-left: 270px;
border: 0px
}

#navigation
{
position:absolute;
top: 80px;
left: 357px;
width:50%;
}


#languages
{
position:absolute;
top: 40px;
left: 740px;
width:50%;
}
</style>



<!-- Header graphic is common to all pages  -->
<div id="header"><img id="header_image" alt="FlossManuals menu" src="http://www.flossmanuals.net/_templates/fm_resources/header_menu.gif" height="95" width="465" border="0"></div>


<!-- Navigation buttons are language and context specific  -->
<div id="navigation">
<a title="Read" href="http://en.flossmanuals.net/index.php"><img src="http://www.flossmanuals.net/_templates/fm_resources/read_en.png" width="65" height="30" border="0" alt="Read"></a>
<a title="Write" href="http://booki.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/write_active_en.png" width="65" height="30" border="0" alt="Write"></a>
<a title="Remix" href="http://en.flossmanuals.net/index.php?plugin=remix"><img src="http://www.flossmanuals.net/_templates/fm_resources/remix_en.png" width="65" height="30" border="0" alt="Remix"></a>
<a title="About" href="http://www.flossmanuals.org"><img src="http://www.flossmanuals.net/_templates/fm_resources/about_en.png" width="65" height="30" border="0" alt="About"></a>
</div>

<!-- Language buttons are common to all pages  -->
<div id="languages">
<a title="English" href="http://en.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/english_button.png" width="65" height="30" border="0" alt="English"></a>

<!-- <a title="Español" href="http://es.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/spanish_button.png" width="65" height="30" border="0" alt="Español"></a> -->
<a title="فارسی" href="http://fa.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/farsi_button.png" width="65" height="30" border="0" alt="فارسی"></a>
<a title="Suomi" href="http://fi.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/finnish_button.png" width="65" height="30" border="0" alt="Suomi"></a>
<br>
<a title="Français" href="http://fr.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/french_button.png" width="65" height="30" border="0" alt="Français"></a>
<a title="Nederlands" href="http://nl.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/dutch_button.png" width="65" height="30" border="0" alt="Nederlands"></a>
<!-- <a title="Pусский" href="http://ru.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/russian_button.png" width="65" height="30" border="0" alt="Pусский"></a> -->
<a title="Translate" href="http://translate.flossmanuals.net/"><img src="http://www.flossmanuals.net/_templates/fm_resources/translate_button.png" width="65" height="30" border="0" alt="Translate"></a>
</div>

<!-- End top bar -->

<!-- nav box + drop shadow -->
<div class="navbox shadow" style="top:160px;">
    		<ul>

 		<li><a href="/accounts/signin/?redirect=/csound/_draft/_v/1.0/web-based-csound/">Sign In</li><li>Register</a></li>

                <li><a href="/list-books">All Manuals</a></li>
                <li><a href="/list-groups">All Groups</a></li>
                <li><a href="/list-people/">All People</a></li>
           	</ul>
</div>
<!-- End of nav box -->



<div class="content-container shadow">
<!-- Content box and the drop shadow-->




<br clear="all"/>
   <h1>CSound</h1>


<div id="bookmenu"   style="background: url(/site_static/images/draft_bg.png) repeat !important;">
<ul>

 
   <li><b>INTRODUCTION</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/introduction/">PREFACE</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/how-to-use-this-manual/">HOW TO USE THIS MANUAL</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/on-this-release/">ON THIS RELEASE</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/credits/">CREDITS</a></li>
 

 
   <li><b>01 BASICS</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-digital-audio/">A. DIGITAL AUDIO</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-pitch-and-frequency/">B. PITCH AND FREQUENCY</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-intensities/">C. INTENSITIES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/random/">D. RANDOM</a></li>
 

 
   <li><b>02 QUICK START</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-make-csound-run/">A. MAKE CSOUND RUN</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-csound-syntax/">B. CSOUND SYNTAX</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-configuring-midi/">C. CONFIGURING MIDI</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-live-audio/">D. LIVE AUDIO</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-rendering-to-file/">E. RENDERING TO FILE</a></li>
 

 
   <li><b>03 CSOUND LANGUAGE</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-initialization-and-performance-pass/">A. INITIALIZATION AND PERFORMANCE PASS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-local-and-global-variables/">B. LOCAL AND GLOBAL VARIABLES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-control-structures/">C. CONTROL STRUCTURES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-function-tables/">D. FUNCTION TABLES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/arrays/">E. ARRAYS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-triggering-instrument-events/">F. LIVE EVENTS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/f-user-defined-opcodes/">G. USER DEFINED OPCODES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/macros/">H. MACROS</a></li>
 

 
   <li><b>04 SOUND SYNTHESIS</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-additive-synthesis/">A. ADDITIVE SYNTHESIS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-subtractive-synthesis/">B. SUBTRACTIVE SYNTHESIS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-amplitude-and-ringmodulation/">C. AMPLITUDE AND RING MODULATION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-frequency-modulation/">D. FREQUENCY MODULATION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-waveshaping/">E. WAVESHAPING</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/f-granular-synthesis/">F. GRANULAR SYNTHESIS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/g-physical-modelling/">G. PHYSICAL MODELLING</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/scanned-synthesis/">H. SCANNED SYNTHESIS</a></li>
 

 
   <li><b>05 SOUND MODIFICATION</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-envelopes/">A. ENVELOPES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-panning-and-spatialization/">B. PANNING AND SPATIALIZATION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-filters/">C. FILTERS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-delay-and-feedback/">D. DELAY AND FEEDBACK</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-reverberation/">E. REVERBERATION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/f-am-rm-waveshaping/">F. AM / RM / WAVESHAPING</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/g-granular-synthesis/">G. GRANULAR SYNTHESIS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/h-convolution/">H. CONVOLUTION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/i-fourier-analysis-spectral-processing/">I. FOURIER ANALYSIS / SPECTRAL PROCESSING</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/k-ats-resynthesis/">K. ATS RESYNTHESIS</a></li>
 

 
   <li><b>06 SAMPLES</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-record-and-play-soundfiles/">A. RECORD AND PLAY SOUNDFILES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-record-and-play-buffers/">B. RECORD AND PLAY BUFFERS</a></li>
 

 
   <li><b>07 MIDI</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/a-receiving-events-by-midiin/">A. RECEIVING EVENTS BY MIDIIN</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/b-triggering-instrument-instances/">B. TRIGGERING INSTRUMENT INSTANCES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-working-with-controllers/">C. WORKING WITH CONTROLLERS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-reading-midi-files/">D. READING MIDI FILES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-midi-output/">E. MIDI OUTPUT</a></li>
 

 
   <li><b>08 OTHER COMMUNICATION</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/osc-and-wii/">A. OPEN SOUND CONTROL</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-in-arduino/">B. CSOUND AND ARDUINO</a></li>
 

 
   <li><b>09 CSOUND IN OTHER APPLICATIONS</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-in-pd/">A. CSOUND IN PD</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-in-maxmsp/">B. CSOUND IN MAXMSP</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-in-ableton-live/">C. CSOUND IN ABLETON LIVE</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-csound-as-a-vst-plugin/">D. CSOUND AS A VST PLUGIN</a></li>
 

 
   <li><b>10 CSOUND FRONTENDS</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/qutecsound/">CSOUNDQT</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/cecilia/">CABBAGE</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/blue/">BLUE</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/winxound/">WINXOUND</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-via-terminal/">CSOUND VIA TERMINAL</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/web-based-csound/">WEB BASED CSOUND</a></li>
 

 
   <li><b>11 CSOUND UTILITIES</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/csound-utilities/">CSOUND UTILITIES</a></li>
 

 
   <li><b>12 CSOUND AND OTHER PROGRAMMING LANGUAGES</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/the-csound-api/">A. THE CSOUND API</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/using-python-inside-csound/">B. PYTHON INSIDE CSOUND</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/c-python-in-csoundqt/">C. PYTHON IN CSOUNDQT</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/d-lua-in-csound/">D. LUA IN CSOUND</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/e-csound-in-ios/">E. CSOUND IN iOS</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/f-csound-on-android/">F. CSOUND ON ANDROID</a></li>
 

 
   <li><b>13 EXTENDING CSOUND</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/extending-csound/">EXTENDING CSOUND</a></li>
 

 
   <li><b>OPCODE GUIDE</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/overview/">OVERVIEW</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/signal-processing-i/">SIGNAL PROCESSING I</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/signal-processing-ii/">SIGNAL PROCESSING II</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/data/">DATA</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/realtime-interaction/">REALTIME INTERACTION</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/instrument-control/">INSTRUMENT CONTROL</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/math-pythonsystem-plugins/">MATHS, PYTHON/SYSTEM, PLUGINS</a></li>
 

 
   <li><b>APPENDIX</b></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/writing-csound-scores-by-hand/">METHODS OF WRITING CSOUND SCORES</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/glossary/">GLOSSARY</a></li>
 

 
   <li><a href="/csound/_draft/_v/1.0/links/">LINKS</a></li>
 

</ul>
</div>
<div id="bookcontent"   >
<h1>WEB BASED CSOUND</h1><h2>pNaCl - Csound for Portable Native Client</h2><p>Csound can now be run within a web browser with no requirement for Csound to be installed on the system from which it is accessed. Csound for Portable Native Client has been developed by Victor Lazzarini and is made possible through Google's Native Client technology (NaCl) and HTML5. &nbsp;</p><p>Csound for pNaCl will work by default with recent versions of the Google Chrome browser (it is not currently supported within Firefox) so this is the recommended browser.</p><p>Through pNaCl, web pages can run Csound .csds and the user can interact with the .csd through on-screen buttons, sliders and canvases.</p><p>More information on Csound for pNaCl can be found <a href="http://vlazzarini.github.io/" target="" title="">here</a>.</p><p><img src="static/pNaCl.png">&nbsp;</p><p>&nbsp;</p><h2 id="csoundemscripten-a-javascript-library-for-csound-on-the-web">CsoundEmscripten - A Javascript Library for Csound on the Web</h2>
<h3 id="introduction">Introduction</h3>
<p><a href="https://github.com/eddyc/CsoundEmscripten"><em>CsoundEmscripten</em></a>
 is an audio API for the web that makes it possible to run Csound in any
 standards compliant web browser without the need for plugins or add
ons. This is made possible by using <a href="http://Emscripten.org"><em>Emscripten</em></a>,
 a program that can convert software written in C (such as Csound) into
Javascript, allowing it to be run natively within any web browser that
supports modern web standards. </p>
<h3 id="caveats">Caveats</h3>
<p>CsoundEmscripten is currently in very early stages of development and
 therefore there are a number of caveats and limitations with its
current implementation which should be noted. </p>
<ul>
<li>
<p>Emscripten generates a highly optimisable subset of Javascript called <a href="http://asmjs.org"><em>asm.js</em></a>.
 This allows Javascript engines which have been optimised for this
subset to achieve substantial performance increases over other
Javascript engines. At this time the only Javascript engine that
supports asm.js optimisations is the Spider Monkey engine which is part
of Firefox. Therefore CsoundEmscripten will perform best on the current
version of Firefox.</p></li>
<li>
<p>At this time, due to the design of the Web Audio API,
CsoundEmscripten can only execute within the main thread of a web page.
This means that it must pause execution of any performance when any
other process that uses the main thread (such as the UI) needs to
execute. This can cause dropouts and/or glitching of the audio during a
performance.</p></li>
<li>
<p>As this project is in its infancy, there are a minimal number of
routines implemented so far in order to instantiate, compile and perform
 a .csd file. Additional routines will be added over time as the project
 matures. </p></li>
</ul>
<h3 id="getting-csoundemscripten">Getting CsoundEmscripten</h3>
<p>CsoundEmscripten can be downloaded using git from the repository at github.</p>
<pre><code>git clone https://github.com/eddyc/CsoundEmscripten.git
</code></pre>

<p>This repository contains a website which uses CsoundEmscripten. The
Csound library can be found in the javascripts directory. In order to
view some examples of CsoundEmscripten in action the website can be
loaded into a browser locally by opening index.html found in the root
directory. A live example of this website can also be found on the
internet <a href="https://eddyc.github.io/CsoundEmscripten">here</a>.</p>
<h3 id="using-csoundemscripten">Using CsoundEmscripten</h3>
<p>In order to demonstrate how to use CsoundEmscripten, what follows is a
 tutorial which shows the steps necessary to create a simple website
that can open .csd files, compile them, and play them back from the
browser. </p>
<h4 id="create-a-simple-website">Create a simple website</h4>
<p>First create a new folder for the website and copy the javascripts
folder from CsoundEmscripten into the new websites directory. Next,
create an index.html file at the top level of the new websites directory
 that contains the following minimal html code:</p>
<pre><code class="html">&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;
&lt;script src="javascripts/libcsound.js"&gt;&lt;/script&gt;
&lt;script src="javascripts/CsoundObj.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>This html page imports the Csound javascript library from the
javascripts directory along with the CsoundObj.js file. The CsoundObj.js
 file defines the CsoundObj object which wraps the libcsound.js library
and defines a number of helper methods that make using the libcsound.js
library more convenient.</p>
<h4 id="instantiate-csound">Instantiate Csound</h4>
<p>We need to write some Javascript to create an instance of CsoundObj,
so within the body tags add new script tags and insert the following
code:</p>
<pre><code class="html">...
&lt;body&gt;
&lt;script&gt;
var csound = new CsoundObj();
&lt;/script&gt;
&lt;/body&gt;
...
</code></pre>

<p>The Javascript console of the web browser should now show some
messages that give the version number of Csound, the build date and the
version of libsndfile being used by Csound.</p>
<h4 id="implement-file-upload-facility">Implement file upload facility</h4>
<p>Now we will create a button for uploading a .csd file. This button
will open up the browsers file choser dialogue where a .csd file can be
selected for upload from the local file system. When the file has been
chosen, it is uploaded to Emscriptens virtual file system. This allows
Csound to get access to the .csd file for compilation.</p>
<p>Add the following code to the index.html file:</p>
<pre><code class="html">...
&lt;body&gt;
&lt;script&gt;
var csound = new CsoundObj();
var reader = new FileReader();
var file;
var fileInputButton = document.createElement("INPUT");
fileInputButton.setAttribute("type", "file");

document.body.appendChild(fileInputButton);

function handleFileSelect(evt) {

    var files = evt.target.files;
    file = files[0];
    console.log(file.name);
    reader.readAsBinaryString(file);
}

reader.onload = (function(theFile) {

    return function(e) {

        FS.createDataFile('/', file.name, e.target.result, true, false);
    };
})(file)

fileInputButton.addEventListener('change', handleFileSelect, false);

&lt;/script&gt;
&lt;/body&gt;
...
</code></pre>

<p>After Csound has been instantiated a FileReader object is created.
The FileReader object allows the webpage to read files from the local
file system and store them as a Javascript object. Next, there is a
Javascript variable to store the file and the file input button is
instantiated and appended to the web page.</p>
<p>In order for the FileReader object to work properly we need to define
 two functions for working with the file chosen from the local file
system. The first function <em>handleFileSelect</em> will be executed
when a file has been selected from the file choser menu. The chosen
files name is logged to the Javascript console and then read using the
FileReader object, in this case as a binary string. The second function <em>reader.onload</em>
 will be executed when the file has finished being read by the
FileReader object. In this case it uses the method provided by
Emscripten <em>createDatafile</em>, to add the selected file to
Emscriptens virtual file system. Finally, an event listener is added to
the fileInputButton to trigger the <em>handleFileSelect</em> function when the file has been selected.</p>
<h4 id="compiling-the-csd-file">Compiling the .csd file</h4>
<p>When the .csd file has been uploaded to Emscriptens virtual file
system it can then be compiled using Csound. Add the following code to
the index.html file</p>
<pre><code>...
fileInputButton.addEventListener('change', handleFileSelect, false);

function compile() {

    csound.compileCSD(file.name);
}
var compileButton = document.createElement("BUTTON");
var buttonText = document.createTextNode("Compile");
compileButton.appendChild(buttonText);
compileButton.onclick = compile;
document.body.appendChild(compileButton);

&lt;/script&gt;
...
</code></pre>

<p>Here we first define the <em>compile</em> function which triggers the compilation of the .csd file. We then create a new button with a text label, point the <em>onclick</em> method to our <em>compile</em> function and append it to the body of the webpage.</p>
<h4 id="perform-the-csd-file">Perform the .csd file</h4>
<p>Finally when the .csd file has been compiled we need to start the
csound performance. Similarly to the compile button, we first define a <em>play</em> function which starts the csound performance. We then create our play button, point the <em>onclick</em> method to the <em>play</em> function and add it to the webpage:</p>
<pre><code>...
function play() {

    csound.startAudioCallback();
}
var playButton = document.createElement("BUTTON");
var buttonText = document.createTextNode("Play");
playButton.appendChild(buttonText);
playButton.onclick = play;
document.body.appendChild(playButton);
...
</code></pre>

<p>When the finished website is loaded, it should be possible now to
select a file, compile it and play it back using CsoundEmscripten. Here
is the full code for the index.html website:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;
&lt;script src="javascripts/libcsound.js"&gt;&lt;/script&gt;
&lt;script src="javascripts/CsoundObj.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script&gt;

var csound = new CsoundObj();
var reader = new FileReader();
var file;
var fileInputButton = document.createElement("INPUT");
fileInputButton.setAttribute("type", "file");
document.body.appendChild(fileInputButton);

function handleFileSelect(evt) {

    var files = evt.target.files;
    file = files[0];
    console.log(file.name);
    reader.readAsBinaryString(file);
}

reader.onload = (function(theFile) {

    return function(e) {

        FS.createDataFile('/', file.name, e.target.result, true, false);
    };
})(file)

fileInputButton.addEventListener('change', handleFileSelect, false);

function compile() {

    csound.compileCSD(file.name);
}
var compileButton = document.createElement("BUTTON");
var buttonText = document.createTextNode("Compile");
compileButton.appendChild(buttonText);
compileButton.onclick = compile;
document.body.appendChild(compileButton);

function play() {

    csound.startAudioCallback();
}
var playButton = document.createElement("BUTTON");
var buttonText = document.createTextNode("Play");
playButton.appendChild(buttonText);
playButton.onclick = play;
document.body.appendChild(playButton);

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>

<h3 id="csoundobjjs-reference">CsoundObj.js Reference</h3>
<p><strong><em>CsoundObj.compileCSD(fileName)</em></strong> </p>
<p>This method takes as its argument the address of a CSD file <em>fileName</em> and compiles it for performance. The CSD file must be present in Emscripten's virtual filesystem.</p>
<hr>
<p><strong><em>CsoundObj.enableAudioInput()</em></strong></p>
<p>This method enables audio input to the web browser. When called, it
triggers a permissions dialogue in the host web browser requesting
permission to allow audio input. If permission is granted, audio input
is available for the running Csound instance.</p>
<hr>
<p><strong><em>CsoundObj.startAudioCallback()</em></strong></p>
<p>This method starts the performance of a compiled CSD file.            <br>
</p>
<hr>
<p><strong><em>CsoundObj.stopAudioCallback()</em></strong></p>
<p>This method stops the performance of a compiled CSD file.             <br>
</p>
<hr>
<p><strong><em>CsoundObj.addControlChannel(name, initialValue)</em></strong></p>
<p>This method adds an object to a Javascript array that is used to
update Csound's named channel values. Each object contains a string
value given by <em>name</em>, a float value given by <em>initialValue</em> and additionally a boolean value indicating whether the float value has been updated.</p>
<hr>
<p><strong><em>CsoundObj.setControlChannelValue(name, value)</em></strong></p>
<p>This method sets a named control channel given by the string <em>name</em> to the specified number given by the <em>value</em> argument.</p>
<hr>
<p><strong><em>CsoundObj.getControlChannelValue(name)</em></strong></p>
<p>This method returns the current value of a named control channel given by the string <em>name</em>.</p>
   <hr/>
    <a href="/csound/_edit/">EDIT</a>

</div>

<script type="text/javascript">
jQuery(function ($) {
    $('#bookcontent').annotator()
   		.annotator('setupPlugins', {}, {
                Tags: false,
                Filter: {
                  addAnnotationFilter: false
                },
                Permissions: false,
                AnnotateItPermissions: {}
              });
});
</script>



</div>
<!-- End of content -->

</div>  
<!-- DEV TOOLS -->
<div id="bookidebug">
</div>

<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
</body>
</html>

